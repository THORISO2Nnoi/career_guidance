<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grades 11-12 - Smart Career Pathfinder</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Additional styles for enhanced features */
        .interest-selector {
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        
        .interest-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .interest-card {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .interest-card:hover {
            border-color: #4dabf7;
            transform: translateY(-2px);
        }
        
        .interest-card.selected {
            border-color: #339af0;
            background-color: #e7f5ff;
        }
        
        .interest-icon {
            font-size: 24px;
            margin-bottom: 10px;
            color: #495057;
        }
        
        .interest-card.selected .interest-icon {
            color: #339af0;
        }
        
        .market-demand-indicator {
            display: inline-flex;
            align-items: center;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
            margin-left: 10px;
        }
        
        .demand-high {
            background-color: #d3f9d8;
            color: #2b8a3e;
        }
        
        .demand-medium {
            background-color: #fff3bf;
            color: #e67700;
        }
        
        .demand-low {
            background-color: #ffe3e3;
            color: #c92a2a;
        }
        
        .recommendation-score {
            display: flex;
            align-items: center;
            margin-top: 10px;
            font-size: 14px;
        }
        
        .score-bar {
            flex-grow: 1;
            height: 6px;
            background-color: #e9ecef;
            border-radius: 3px;
            margin: 0 10px;
            overflow: hidden;
        }
        
        .score-fill {
            height: 100%;
            background-color: #40c057;
            border-radius: 3px;
        }
        
        .recommendation-factors {
            margin-top: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            font-size: 14px;
        }
        
        .factor-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        
        .factor-value {
            font-weight: 600;
        }
        
        .match-high {
            color: #40c057;
        }
        
        .match-medium {
            color: #fab005;
        }
        
        .match-low {
            color: #fa5252;
        }
        
        .career-insights {
            margin-top: 30px;
        }
        
        .insight-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .insight-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .insight-icon {
            font-size: 20px;
            margin-right: 10px;
            color: #339af0;
        }
    </style>
</head>
<body>
    <header class="main-header">
        <div class="header-content">
            <h1 class="header-title">
                <i class="fas fa-graduation-cap"></i>
                Grade 11-12 Career Navigator
            </h1>
            <p class="header-subtitle">Transform your results into your future career path</p>
        </div>
        <div class="header-graphic">
            <div class="graphic-item">
                <i class="fas fa-calculator"></i>
                <span>APS Calculator</span>
            </div>
            <div class="graphic-item">
                <i class="fas fa-chart-line"></i>
                <span>Career Analysis</span>
            </div>
            <div class="graphic-item">
                <i class="fas fa-university"></i>
                <span>University Matching</span>
            </div>
        </div>
    </header>
    
    <main class="main-content">
        <div class="container">
            <nav class="breadcrumb">
                <a href="index.html" class="breadcrumb-link">
                    <i class="fas fa-home"></i>
                    Home
                </a>
                <span class="breadcrumb-separator">/</span>
                <span class="breadcrumb-current">Grade 11-12 Career Navigator</span>
            </nav>
            
            <div class="card main-card">
                <div class="card-header">
                    <h2 class="card-title">
                        <i class="fas fa-rocket"></i>
                        Launch Your Future Career
                    </h2>
                    <p class="card-subtitle">Upload your results and discover your ideal career path with our intelligent APS calculator</p>
                </div>
                
                <div class="grade-selector">
                    <div class="selector-label">
                        <i class="fas fa-user-graduate"></i>
                        Select Your Academic Level
                    </div>
                    <div class="selector-buttons">
                        <button class="selector-btn active" data-grade="11">
                            <i class="fas fa-star"></i>
                            Grade 11
                        </button>
                        <button class="selector-btn" data-grade="12">
                            <i class="fas fa-trophy"></i>
                            Grade 12
                        </button>
                    </div>
                </div>
                
                <div class="steps-container">
                    <div class="step-indicator">
                        <div class="step active" data-step="1">
                            <div class="step-number">1</div>
                            <div class="step-label">Upload Results</div>
                        </div>
                        <div class="step-connector"></div>
                        <div class="step" data-step="2">
                            <div class="step-number">2</div>
                            <div class="step-label">Interest Assessment</div>
                        </div>
                        <div class="step-connector"></div>
                        <div class="step" data-step="3">
                            <div class="step-number">3</div>
                            <div class="step-label">Career Pathways</div>
                        </div>
                    </div>
                    
                    <div class="steps-content">
                        <!-- Step 1: Upload -->
                        <div class="step-content active" id="step1">
                            <div class="upload-section">
                                <div class="upload-card">
                                    <div class="upload-icon">
                                        <i class="fas fa-cloud-upload-alt"></i>
                                    </div>
                                    <h3>Upload Your Academic Results</h3>
                                    <p>Get instant APS calculation and personalized career recommendations</p>
                                    
                                    <div class="upload-area" id="uploadArea">
                                        <div class="upload-placeholder">
                                            <i class="fas fa-file-pdf"></i>
                                            <p>Drag & drop your results file here</p>
                                            <span class="upload-hint">Supports PDF, JPG, PNG (Max 5MB)</span>
                                        </div>
                                        <input type="file" id="resultsFile" accept=".pdf,.jpg,.jpeg,.png" hidden>
                                        <button class="btn btn-primary btn-upload" id="uploadTrigger">
                                            <i class="fas fa-folder-open"></i>
                                            Choose File
                                        </button>
                                    </div>
                                    
                                    <div class="upload-status" id="uploadStatus"></div>
                                </div>
                                
                                <div class="divider">
                                    <span>OR</span>
                                </div>
                                
                                <div class="manual-entry-card">
                                    <h4>
                                        <i class="fas fa-keyboard"></i>
                                        Enter Results Manually
                                    </h4>
                                    <div class="manual-input">
                                        <div class="input-group">
                                            <input type="text" class="subject-name" placeholder="Subject name (e.g., Mathematics)">
                                            <input type="number" class="subject-mark" placeholder="Mark %" min="0" max="100">
                                            <button class="btn btn-success add-subject-btn">
                                                <i class="fas fa-plus"></i>
                                                Add
                                            </button>
                                        </div>
                                        <div id="subjectsList" class="subjects-list"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="action-bar">
                                <button class="btn btn-primary btn-lg" id="calculateBtn" disabled>
                                    <i class="fas fa-calculator"></i>
                                    Calculate APS & Analyze Career Paths
                                </button>
                            </div>
                        </div>
                        
                        <!-- Step 2: Interest Assessment -->
                        <div class="step-content" id="step2">
                            <div class="interest-selector">
                                <h3>
                                    <i class="fas fa-heart"></i>
                                    Select Your Areas of Interest
                                </h3>
                                <p>Choose at least 3 areas that interest you to get personalized career recommendations</p>
                                
                                <div class="interest-grid" id="interestGrid">
                                    <!-- Interest cards will be populated by JavaScript -->
                                </div>
                            </div>
                            
                            <div class="action-bar">
                                <button class="btn btn-outline" id="backToStep1">
                                    <i class="fas fa-arrow-left"></i>
                                    Back to Results
                                </button>
                                <button class="btn btn-primary" id="analyzeInterestsBtn" disabled>
                                    <i class="fas fa-chart-line"></i>
                                    Generate Career Recommendations
                                </button>
                            </div>
                        </div>
                        
                        <!-- Step 3: Results -->
                        <div class="step-content" id="step3">
                            <div class="loading-section" id="loadingResults">
                                <div class="loading-animation">
                                    <div class="loading-spinner"></div>
                                    <div class="loading-dots">
                                        <span></span>
                                        <span></span>
                                        <span></span>
                                    </div>
                                </div>
                                <h3>Analyzing Your Academic Potential</h3>
                                <p>Calculating APS score and matching with optimal career pathways...</p>
                            </div>
                            
                            <div class="results-section" id="resultsContainer">
                                <!-- APS Score Card -->
                                <div class="results-hero">
                                    <div class="aps-hero-card">
                                        <div class="aps-badge">
                                            <div class="aps-score" id="apsValue">0</div>
                                            <div class="aps-label">APS Score</div>
                                        </div>
                                        <div class="aps-details">
                                            <h3>Admission Points Score Analysis</h3>
                                            <p id="apsDescription" class="aps-description"></p>
                                            <div class="performance-tag" id="performanceLevel"></div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Quick Stats -->
                                <div class="stats-grid">
                                    <div class="stat-card">
                                        <div class="stat-icon">
                                            <i class="fas fa-chart-bar"></i>
                                        </div>
                                        <div class="stat-content">
                                            <div class="stat-value" id="overallAverage">0%</div>
                                            <div class="stat-label">Overall Average</div>
                                        </div>
                                    </div>
                                    <div class="stat-card">
                                        <div class="stat-icon">
                                            <i class="fas fa-book"></i>
                                        </div>
                                        <div class="stat-content">
                                            <div class="stat-value" id="subjectsCount">0</div>
                                            <div class="stat-label">Subjects</div>
                                        </div>
                                    </div>
                                    <div class="stat-card">
                                        <div class="stat-icon">
                                            <i class="fas fa-star"></i>
                                        </div>
                                        <div class="stat-content">
                                            <div class="stat-value" id="distinctionCount">0</div>
                                            <div class="stat-label">Distinctions</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- APS Breakdown -->
                                <div class="section-card">
                                    <h3 class="section-title">
                                        <i class="fas fa-list-alt"></i>
                                        Detailed APS Breakdown
                                    </h3>
                                    <div id="apsBreakdown" class="breakdown-grid"></div>
                                </div>
                                
                                <!-- Personalized Course Recommendations -->
                                <div class="section-card">
                                    <h3 class="section-title">
                                        <i class="fas fa-graduation-cap"></i>
                                        Personalized Career Pathways
                                        <small>Based on your academic performance and interests</small>
                                    </h3>
                                    <div id="courseList" class="courses-grid"></div>
                                </div>
                                
                                <!-- Market Insights -->
                                <div class="career-insights">
                                    <div class="section-card">
                                        <h3 class="section-title">
                                            <i class="fas fa-chart-line"></i>
                                            Market Demand Insights
                                        </h3>
                                        <div id="marketInsights" class="insights-container"></div>
                                    </div>
                                </div>
                                
                                <!-- Skills Recommendations -->
                                <div class="section-card">
                                    <h3 class="section-title">
                                        <i class="fas fa-tools"></i>
                                        Essential Skills Development
                                    </h3>
                                    <div id="skillList" class="skills-grid"></div>
                                </div>
                                
                                <!-- University Prospects -->
                                <div class="section-card">
                                    <h3 class="section-title">
                                        <i class="fas fa-university"></i>
                                        Higher Education Prospects
                                    </h3>
                                    <div id="universityInfo" class="university-card"></div>
                                </div>
                            </div>
                            
                            <div class="action-bar">
                                <button class="btn btn-outline" id="newCalculationBtn">
                                    <i class="fas fa-redo"></i>
                                    Analyze Another Result
                                </button>
                                <button class="btn btn-primary" id="printResultsBtn">
                                    <i class="fas fa-print"></i>
                                    Print Results
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    <footer class="main-footer">
        <div class="footer-content">
            <div class="footer-section">
                <h4>Career Guidance Portal</h4>
                <p>Empowering students to make informed career decisions through intelligent analysis and personalized recommendations.</p>
            </div>
            <div class="footer-section">
                <h4>Quick Links</h4>
                <a href="index.html">Home</a>
                <a href="grade9.html">Grade 9</a>
                <a href="grade10.html">Grade 10</a>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2023 Student Career Guidance Portal. All rights reserved.</p>
        </div>
    </footer>
    
    <script>
        // Global variables
        let uploadedFile = null;
        let manualSubjects = [];
        let currentGrade = '11';
        let selectedInterests = [];
        
        // Interest categories with market demand data
        const interestCategories = [
            {
                id: 'technology',
                name: 'Technology & IT',
                icon: 'fas fa-laptop-code',
                description: 'Software development, cybersecurity, data science',
                marketDemand: 'high',
                growthRate: '22%',
                avgSalary: 'R450k - R900k'
            },
            {
                id: 'health',
                name: 'Health Sciences',
                icon: 'fas fa-heartbeat',
                description: 'Medicine, nursing, pharmacy, medical research',
                marketDemand: 'high',
                growthRate: '15%',
                avgSalary: 'R350k - R1.2m'
            },
            {
                id: 'engineering',
                name: 'Engineering',
                icon: 'fas fa-cogs',
                description: 'Civil, mechanical, electrical, chemical engineering',
                marketDemand: 'medium',
                growthRate: '8%',
                avgSalary: 'R400k - R800k'
            },
            {
                id: 'business',
                name: 'Business & Finance',
                icon: 'fas fa-chart-line',
                description: 'Accounting, finance, marketing, entrepreneurship',
                marketDemand: 'medium',
                growthRate: '10%',
                avgSalary: 'R300k - R700k'
            },
            {
                id: 'arts',
                name: 'Creative Arts',
                icon: 'fas fa-palette',
                description: 'Graphic design, film, writing, performing arts',
                marketDemand: 'medium',
                growthRate: '6%',
                avgSalary: 'R200k - R500k'
            },
            {
                id: 'education',
                name: 'Education',
                icon: 'fas fa-chalkboard-teacher',
                description: 'Teaching, educational psychology, curriculum development',
                marketDemand: 'medium',
                growthRate: '7%',
                avgSalary: 'R250k - R550k'
            },
            {
                id: 'sciences',
                name: 'Natural Sciences',
                icon: 'fas fa-flask',
                description: 'Biology, chemistry, physics, environmental science',
                marketDemand: 'medium',
                growthRate: '9%',
                avgSalary: 'R300k - R650k'
            },
            {
                id: 'social',
                name: 'Social Sciences',
                icon: 'fas fa-users',
                description: 'Psychology, sociology, anthropology, social work',
                marketDemand: 'medium',
                growthRate: '8%',
                avgSalary: 'R250k - R500k'
            },
            {
                id: 'law',
                name: 'Law & Justice',
                icon: 'fas fa-gavel',
                description: 'Law, criminology, paralegal studies, human rights',
                marketDemand: 'medium',
                growthRate: '7%',
                avgSalary: 'R350k - R800k'
            },
            {
                id: 'trades',
                name: 'Skilled Trades',
                icon: 'fas fa-tools',
                description: 'Electrician, plumber, welder, automotive technician',
                marketDemand: 'high',
                growthRate: '12%',
                avgSalary: 'R200k - R500k'
            }
        ];

        // DOM Content Loaded
        document.addEventListener('DOMContentLoaded', function() {
            initGrade11_12Page();
        });

        function initGrade11_12Page() {
            // Initialize file upload
            initFileUpload();
            
            // Initialize grade selector
            initGradeSelector();
            
            // Initialize manual subject entry
            initManualEntry();
            
            // Initialize action buttons
            initActionButtons();
            
            // Initialize interest selector
            initInterestSelector();
        }

        function initFileUpload() {
            const uploadTrigger = document.getElementById('uploadTrigger');
            const resultsFile = document.getElementById('resultsFile');
            const uploadArea = document.getElementById('uploadArea');

            uploadTrigger.addEventListener('click', () => resultsFile.click());
            
            resultsFile.addEventListener('change', function(e) {
                handleFileUpload(e);
            });

            // Drag and drop functionality
            setupDragAndDrop();
        }

        function initGradeSelector() {
            const selectorBtns = document.querySelectorAll('.selector-btn');
            
            selectorBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    selectorBtns.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentGrade = this.dataset.grade;
                    updateStepIndicator(1);
                });
            });
        }

        function initManualEntry() {
            const addSubjectBtn = document.querySelector('.add-subject-btn');
            
            addSubjectBtn.addEventListener('click', addManualSubject);

            // Enter key for manual subject entry
            const subjectInputs = document.querySelectorAll('.subject-name, .subject-mark');
            subjectInputs.forEach(input => {
                input.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        addManualSubject();
                    }
                });
            });
        }

        function initActionButtons() {
            const calculateBtn = document.getElementById('calculateBtn');
            const newCalculationBtn = document.getElementById('newCalculationBtn');
            const printResultsBtn = document.getElementById('printResultsBtn');
            const backToStep1 = document.getElementById('backToStep1');
            const analyzeInterestsBtn = document.getElementById('analyzeInterestsBtn');

            calculateBtn.addEventListener('click', function() {
                calculateAPSAndRecommendations();
            });

            newCalculationBtn.addEventListener('click', function() {
                resetForm();
            });

            printResultsBtn.addEventListener('click', function() {
                window.print();
            });
            
            backToStep1.addEventListener('click', function() {
                updateStepIndicator(1);
            });
            
            analyzeInterestsBtn.addEventListener('click', function() {
                generatePersonalizedRecommendations();
            });
        }
        
        function initInterestSelector() {
            const interestGrid = document.getElementById('interestGrid');
            
            // Populate interest grid
            interestCategories.forEach(category => {
                const interestCard = document.createElement('div');
                interestCard.className = 'interest-card';
                interestCard.dataset.id = category.id;
                
                let demandClass = '';
                switch(category.marketDemand) {
                    case 'high': demandClass = 'demand-high'; break;
                    case 'medium': demandClass = 'demand-medium'; break;
                    case 'low': demandClass = 'demand-low'; break;
                }
                
                interestCard.innerHTML = `
                    <div class="interest-icon">
                        <i class="${category.icon}"></i>
                    </div>
                    <h4>${category.name}</h4>
                    <p>${category.description}</p>
                    <span class="market-demand-indicator ${demandClass}">
                        ${category.marketDemand.toUpperCase()} DEMAND
                    </span>
                `;
                
                interestCard.addEventListener('click', function() {
                    this.classList.toggle('selected');
                    const interestId = this.dataset.id;
                    
                    if (this.classList.contains('selected')) {
                        selectedInterests.push(interestId);
                    } else {
                        selectedInterests = selectedInterests.filter(id => id !== interestId);
                    }
                    
                    // Enable/disable analyze button based on selection count
                    document.getElementById('analyzeInterestsBtn').disabled = selectedInterests.length < 3;
                });
                
                interestGrid.appendChild(interestCard);
            });
        }

        function handleFileUpload(e) {
            if (e.target.files.length > 0) {
                uploadedFile = e.target.files[0];
                
                // Validate file
                if (!validateFile(uploadedFile)) {
                    return;
                }
                
                showUploadSuccess(uploadedFile.name);
                document.getElementById('calculateBtn').disabled = false;
            }
        }

        function validateFile(file) {
            // Validate file size (5MB limit)
            if (file.size > 5 * 1024 * 1024) {
                showUploadStatus('File size exceeds 5MB limit.', 'error');
                return false;
            }
            
            // Validate file type
            const fileTypes = ['image/jpeg', 'image/jpg', 'image/png', 'application/pdf'];
            if (!fileTypes.includes(file.type)) {
                showUploadStatus('Please upload PDF, JPG, or PNG files only.', 'error');
                return false;
            }
            
            return true;
        }

        function showUploadSuccess(filename) {
            const uploadArea = document.getElementById('uploadArea');
            uploadArea.innerHTML = `
                <div class="upload-success">
                    <div class="success-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="success-content">
                        <p class="success-title">File Ready for Analysis</p>
                        <p class="success-filename">${filename}</p>
                    </div>
                    <button class="btn btn-outline change-file-btn" id="changeFileBtn">
                        <i class="fas fa-sync"></i>
                        Change
                    </button>
                </div>
            `;
            
            document.getElementById('changeFileBtn').addEventListener('click', function() {
                resetFileUpload();
            });
            
            showUploadStatus('File uploaded successfully! Ready for APS calculation.', 'success');
        }

        function resetFileUpload() {
            const uploadArea = document.getElementById('uploadArea');
            uploadArea.innerHTML = `
                <div class="upload-placeholder">
                    <i class="fas fa-file-pdf"></i>
                    <p>Drag & drop your results file here</p>
                    <span class="upload-hint">Supports PDF, JPG, PNG (Max 5MB)</span>
                </div>
                <input type="file" id="resultsFile" accept=".pdf,.jpg,.jpeg,.png" hidden>
                <button class="btn btn-primary btn-upload" id="uploadTrigger">
                    <i class="fas fa-folder-open"></i>
                    Choose File
                </button>
            `;
            
            uploadedFile = null;
            document.getElementById('calculateBtn').disabled = true;
            showUploadStatus('', 'clear');
            
            // Re-initialize file upload
            initFileUpload();
        }

        function setupDragAndDrop() {
            const uploadArea = document.getElementById('uploadArea');
            if (!uploadArea) return;

            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                uploadArea.addEventListener(eventName, preventDefaults, false);
            });

            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }

            ['dragenter', 'dragover'].forEach(eventName => {
                uploadArea.addEventListener(eventName, highlight, false);
            });

            ['dragleave', 'drop'].forEach(eventName => {
                uploadArea.addEventListener(eventName, unhighlight, false);
            });

            function highlight() {
                uploadArea.classList.add('drag-over');
            }

            function unhighlight() {
                uploadArea.classList.remove('drag-over');
            }

            uploadArea.addEventListener('drop', handleDrop, false);

            function handleDrop(e) {
                const dt = e.dataTransfer;
                const files = dt.files;
                const resultsFile = document.getElementById('resultsFile');
                
                if (files.length > 0) {
                    resultsFile.files = files;
                    handleFileUpload({ target: { files: files } });
                }
            }
        }

        function showUploadStatus(message, type) {
            const statusElement = document.getElementById('uploadStatus');
            if (!statusElement) return;

            statusElement.textContent = message;
            statusElement.className = 'upload-status';
            
            if (type === 'success') {
                statusElement.classList.add('success');
            } else if (type === 'error') {
                statusElement.classList.add('error');
            } else if (type === 'clear') {
                statusElement.textContent = '';
            }
        }

        function addManualSubject() {
            const subjectNameInput = document.querySelector('.subject-name');
            const subjectMarkInput = document.querySelector('.subject-mark');
            
            const name = subjectNameInput.value.trim();
            const mark = parseInt(subjectMarkInput.value);
            
            if (!name || isNaN(mark) || mark < 0 || mark > 100) {
                showUploadStatus('Please enter a valid subject name and mark (0-100).', 'error');
                return;
            }
            
            manualSubjects.push({
                name: name,
                mark: mark,
                level: getLevel(mark)
            });
            
            renderManualSubjects();
            
            // Clear inputs
            subjectNameInput.value = '';
            subjectMarkInput.value = '';
            
            // Enable calculate button
            document.getElementById('calculateBtn').disabled = false;
            showUploadStatus(`${manualSubjects.length} subjects added. Ready for analysis.`, 'success');
        }

        function renderManualSubjects() {
            const subjectsList = document.getElementById('subjectsList');
            subjectsList.innerHTML = '';
            
            manualSubjects.forEach((subject, index) => {
                const subjectElement = document.createElement('div');
                subjectElement.className = 'subject-item';
                subjectElement.innerHTML = `
                    <div class="subject-info">
                        <span class="subject-name">${subject.name}</span>
                        <span class="subject-mark">${subject.mark}%</span>
                        <span class="subject-level level-${subject.level.toLowerCase().replace(' ', '-')}">${subject.level}</span>
                    </div>
                    <button class="btn btn-danger remove-btn" onclick="removeManualSubject(${index})">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                subjectsList.appendChild(subjectElement);
            });
        }

        function removeManualSubject(index) {
            manualSubjects.splice(index, 1);
            renderManualSubjects();
            
            if (manualSubjects.length === 0) {
                document.getElementById('calculateBtn').disabled = true;
                showUploadStatus('', 'clear');
            }
        }

        // MAIN CALCULATION FUNCTION
        function calculateAPSAndRecommendations() {
            updateStepIndicator(2);
            
            let subjects = [];
            
            // Process manual subjects if available
            if (manualSubjects.length > 0) {
                subjects = manualSubjects;
            } else if (uploadedFile) {
                // For file upload, create sample subjects based on common subjects
                subjects = generateSampleSubjects();
            } else {
                showUploadStatus('Please upload a file or enter subjects manually.', 'error');
                updateStepIndicator(1);
                return;
            }
            
            // Calculate APS and generate results
            const results = calculateAPSResults(subjects);
            
            // Store results for later use
            window.academicResults = results;
        }

        function generatePersonalizedRecommendations() {
            updateStepIndicator(3);
            document.getElementById('loadingResults').style.display = 'flex';
            document.getElementById('resultsContainer').style.display = 'none';

            // Simulate processing time
            setTimeout(() => {
                const academicResults = window.academicResults;
                
                // Generate personalized recommendations based on interests and academic performance
                const personalizedResults = generatePersonalizedResults(academicResults, selectedInterests);
                
                // Display results
                document.getElementById('loadingResults').style.display = 'none';
                document.getElementById('resultsContainer').style.display = 'block';
                displayGrade11_12Results(personalizedResults);
            }, 2000);
        }

        function calculateAPSResults(subjects) {
            // Calculate APS score
            let totalPoints = 0;
            let totalMarks = 0;
            let distinctionCount = 0;
            
            const apsBreakdown = subjects.map(subject => {
                const points = calculateAPSPoints(subject.mark);
                totalPoints += points;
                totalMarks += subject.mark;
                
                if (subject.mark >= 80) {
                    distinctionCount++;
                }
                
                return {
                    subject: subject.name,
                    mark: subject.mark,
                    level: subject.level,
                    points: points
                };
            });
            
            const overallAverage = Math.round(totalMarks / subjects.length);
            const apsScore = totalPoints;
            
            // Generate recommendations based on APS score
            const courses = generateCourseRecommendations(apsScore, subjects);
            const skills = generateSkillRecommendations(apsScore, subjects);
            const summary = generateSummary(apsScore, overallAverage, distinctionCount);
            
            return {
                apsScore: apsScore,
                overallAverage: overallAverage,
                subjects: subjects,
                apsBreakdown: {
                    breakdown: apsBreakdown,
                    totalPoints: apsScore
                },
                courses: courses,
                skills: skills,
                summary: summary
            };
        }

        function generatePersonalizedResults(academicResults, interests) {
            // Get interest-based courses
            const interestCourses = getInterestBasedCourses(interests);
            
            // Merge academic and interest-based recommendations
            const personalizedCourses = mergeRecommendations(academicResults.courses, interestCourses, academicResults.apsScore);
            
            // Generate market insights
            const marketInsights = generateMarketInsights(interests);
            
            return {
                ...academicResults,
                courses: personalizedCourses,
                marketInsights: marketInsights,
                selectedInterests: interests
            };
        }

        function getInterestBasedCourses(interests) {
            let courses = [];
            
            // Define courses for each interest category
            const interestCoursesMap = {
                'technology': [
                    {
                        name: "Software Engineering",
                        category: "Technology & IT",
                        description: "Design, develop, and maintain software systems and applications.",
                        institutions: ["University of Cape Town", "Wits University", "University of Pretoria"],
                        requirements: "Maths (75%+), Physical Science (65%+)",
                        jobProspects: "Excellent",
                        duration: "4 years",
                        salaryRange: "R450k - R900k",
                        marketDemand: "high",
                        matchScore: 95
                    },
                    {
                        name: "Data Science",
                        category: "Technology & IT",
                        description: "Extract insights from complex data using statistical and computational methods.",
                        institutions: ["Stellenbosch University", "UCT", "UNISA"],
                        requirements: "Maths (80%+), IT/Computer Science (70%+)",
                        jobProspects: "Excellent",
                        duration: "3-4 years",
                        salaryRange: "R500k - R950k",
                        marketDemand: "high",
                        matchScore: 90
                    }
                ],
                'health': [
                    {
                        name: "Medicine",
                        category: "Health Sciences",
                        description: "Diagnose and treat illnesses, injuries, and other health conditions.",
                        institutions: ["Wits University", "University of Cape Town", "Stellenbosch University"],
                        requirements: "Maths & Physical Science (80%+), Life Sciences (80%+)",
                        jobProspects: "Excellent",
                        duration: "6 years",
                        salaryRange: "R600k - R1.2m+",
                        marketDemand: "high",
                        matchScore: 98
                    },
                    {
                        name: "Nursing",
                        category: "Health Sciences",
                        description: "Provide patient care, educate patients and the public about health conditions.",
                        institutions: ["University of KwaZulu-Natal", "UWC", "Various Nursing Colleges"],
                        requirements: "Life Sciences (65%+), Maths (60%+)",
                        jobProspects: "Very Good",
                        duration: "4 years",
                        salaryRange: "R300k - R600k",
                        marketDemand: "high",
                        matchScore: 85
                    }
                ],
                'engineering': [
                    {
                        name: "Civil Engineering",
                        category: "Engineering",
                        description: "Design, construct, and maintain infrastructure projects.",
                        institutions: ["University of Pretoria", "Wits University", "Stellenbosch University"],
                        requirements: "Maths & Physical Science (75%+)",
                        jobProspects: "Good",
                        duration: "4 years",
                        salaryRange: "R400k - R800k",
                        marketDemand: "medium",
                        matchScore: 80
                    }
                ],
                'business': [
                    {
                        name: "BCom Accounting",
                        category: "Business & Finance",
                        description: "Professional accounting qualification with CA(SA) potential.",
                        institutions: ["University of Johannesburg", "Nelson Mandela University", "Rhodes University"],
                        requirements: "Maths (60%+)",
                        jobProspects: "Very Good",
                        duration: "3-4 years",
                        salaryRange: "R350k - R600k",
                        marketDemand: "medium",
                        matchScore: 75
                    }
                ]
                // Add more interest-based courses as needed
            };
            
            // Collect courses from selected interests
            interests.forEach(interest => {
                if (interestCoursesMap[interest]) {
                    courses = courses.concat(interestCoursesMap[interest]);
                }
            });
            
            return courses;
        }

        function mergeRecommendations(academicCourses, interestCourses, apsScore) {
            // Combine both sets of courses
            let allCourses = [...academicCourses, ...interestCourses];
            
            // Remove duplicates based on course name
            const uniqueCourses = [];
            const courseNames = new Set();
            
            allCourses.forEach(course => {
                if (!courseNames.has(course.name)) {
                    courseNames.add(course.name);
                    uniqueCourses.push(course);
                }
            });
            
            // Sort by relevance (match score if available, then by APS suitability)
            return uniqueCourses.sort((a, b) => {
                // Prioritize courses with match scores
                if (a.matchScore && b.matchScore) {
                    return b.matchScore - a.matchScore;
                }
                
                // Then prioritize by market demand
                const demandOrder = { 'high': 3, 'medium': 2, 'low': 1 };
                return demandOrder[b.marketDemand] - demandOrder[a.marketDemand];
            });
        }

        function generateMarketInsights(interests) {
            let insights = [];
            
            interests.forEach(interestId => {
                const category = interestCategories.find(cat => cat.id === interestId);
                if (category) {
                    insights.push({
                        category: category.name,
                        demand: category.marketDemand,
                        growth: category.growthRate,
                        salary: category.avgSalary,
                        outlook: getMarketOutlook(category.marketDemand)
                    });
                }
            });
            
            return insights;
        }

        function getMarketOutlook(demand) {
            switch(demand) {
                case 'high':
                    return "Strong growth with excellent job opportunities and competitive salaries";
                case 'medium':
                    return "Stable growth with good job prospects and competitive compensation";
                case 'low':
                    return "Limited growth with competitive job market and variable compensation";
                default:
                    return "Market conditions vary by specialization and location";
            }
        }

        function calculateAPSPoints(mark) {
            if (mark >= 80) return 7; // Distinction
            if (mark >= 70) return 6; // Meritorious
            if (mark >= 60) return 5; // Substantial
            if (mark >= 50) return 4; // Moderate
            if (mark >= 40) return 3; // Adequate
            if (mark >= 30) return 2; // Elementary
            return 1; // Not achieved
        }

        function generateSampleSubjects() {
            const commonSubjects = [
                { name: "Mathematics", mark: Math.floor(Math.random() * 30) + 60 },
                { name: "English", mark: Math.floor(Math.random() * 30) + 60 },
                { name: "Physical Science", mark: Math.floor(Math.random() * 35) + 55 },
                { name: "Life Sciences", mark: Math.floor(Math.random() * 30) + 60 },
                { name: "Accounting", mark: Math.floor(Math.random() * 35) + 55 },
                { name: "Geography", mark: Math.floor(Math.random() * 30) + 60 }
            ];
            
            return commonSubjects.map(subject => ({
                name: subject.name,
                mark: subject.mark,
                level: getLevel(subject.mark)
            }));
        }

        function generateCourseRecommendations(apsScore, subjects) {
            let courses = [];
            
            if (apsScore >= 35) {
                courses = [
                    {
                        name: "Medicine & Surgery",
                        category: "Health Sciences",
                        description: "Become a medical doctor with specialization options in various fields.",
                        institutions: ["University of Cape Town", "Wits University", "Stellenbosch University"],
                        requirements: "Maths & Physical Science (80%+), Life Sciences (75%+)",
                        jobProspects: "Excellent",
                        duration: "6 years",
                        salaryRange: "R600k - R1.2m+",
                        marketDemand: "high"
                    },
                    {
                        name: "Computer Science & Engineering",
                        category: "Engineering & IT",
                        description: "Combine software development with hardware engineering principles.",
                        institutions: ["University of Pretoria", "UCT", "Wits"],
                        requirements: "Maths & Physical Science (75%+)",
                        jobProspects: "Excellent",
                        duration: "4 years",
                        salaryRange: "R400k - R800k",
                        marketDemand: "high"
                    }
                ];
            } else if (apsScore >= 28) {
                courses = [
                    {
                        name: "BCom Accounting",
                        category: "Commerce",
                        description: "Professional accounting qualification with CA(SA) potential.",
                        institutions: ["University of Johannesburg", "Nelson Mandela University", "Rhodes University"],
                        requirements: "Maths (60%+)",
                        jobProspects: "Very Good",
                        duration: "3-4 years",
                        salaryRange: "R350k - R600k",
                        marketDemand: "medium"
                    },
                    {
                        name: "BSc Information Technology",
                        category: "IT",
                        description: "Software development, networking, and IT management.",
                        institutions: ["TUT", "DUT", "Varsity College"],
                        requirements: "Maths (60%+)",
                        jobProspects: "Very Good",
                        duration: "3 years",
                        salaryRange: "R300k - R550k",
                        marketDemand: "high"
                    }
                ];
            } else if (apsScore >= 24) {
                courses = [
                    {
                        name: "Diploma in Marketing",
                        category: "Business",
                        description: "Digital marketing, brand management, and sales.",
                        institutions: ["Vega School", "Boston City Campus", "Damelin"],
                        requirements: "English (50%+)",
                        jobProspects: "Good",
                        duration: "3 years",
                        salaryRange: "R200k - R400k",
                        marketDemand: "medium"
                    },
                    {
                        name: "Diploma in Tourism",
                        category: "Tourism",
                        description: "Tour operations, hospitality, and travel management.",
                        institutions: ["CATHSSETA", "Tourism College", "Various FET Colleges"],
                        requirements: "English (50%+)",
                        jobProspects: "Good",
                        duration: "3 years",
                        salaryRange: "R180k - R350k",
                        marketDemand: "medium"
                    }
                ];
            } else {
                courses = [
                    {
                        name: "Vocational Skills Program",
                        category: "Skills Development",
                        description: "Hands-on training in trades like plumbing, electrical, or automotive.",
                        institutions: ["TVET Colleges", "SETAs", "Private Colleges"],
                        requirements: "NSC Pass",
                        jobProspects: "Stable",
                        duration: "1-2 years",
                        salaryRange: "R150k - R300k",
                        marketDemand: "high"
                    },
                    {
                        name: "Entrepreneurship Program",
                        category: "Business",
                        description: "Start your own business with government support programs.",
                        institutions: ["SEDA", "NYDA", "Business Incubators"],
                        requirements: "NSC Pass",
                        jobProspects: "Variable",
                        duration: "6-12 months",
                        salaryRange: "Self-determined",
                        marketDemand: "medium"
                    }
                ];
            }
            
            return courses;
        }

        function generateSkillRecommendations(apsScore, subjects) {
            let skills = [];
            
            const coreSkills = [
                {
                    name: "Digital Literacy",
                    description: "Essential computer skills including MS Office, email, and basic software.",
                    category: "Technical",
                    demandLevel: "High",
                    priority: "Essential"
                },
                {
                    name: "Communication Skills",
                    description: "Verbal and written communication for professional environments.",
                    category: "Soft Skills",
                    demandLevel: "High",
                    priority: "Essential"
                }
            ];
            
            if (apsScore >= 30) {
                skills = [
                    ...coreSkills,
                    {
                        name: "Critical Thinking",
                        description: "Analytical problem-solving and decision-making abilities.",
                        category: "Cognitive",
                        demandLevel: "Very High",
                        priority: "High"
                    },
                    {
                        name: "Data Analysis",
                        description: "Interpreting data and making evidence-based decisions.",
                        category: "Technical",
                        demandLevel: "High",
                        priority: "High"
                    }
                ];
            } else if (apsScore >= 25) {
                skills = [
                    ...coreSkills,
                    {
                        name: "Project Management",
                        description: "Organizing tasks and managing timelines effectively.",
                        category: "Management",
                        demandLevel: "High",
                        priority: "Medium"
                    },
                    {
                        name: "Customer Service",
                        description: "Professional client interaction and relationship building.",
                        category: "Soft Skills",
                        demandLevel: "High",
                        priority: "Medium"
                    }
                ];
            } else {
                skills = [
                    ...coreSkills,
                    {
                        name: "Time Management",
                        description: "Prioritizing tasks and meeting deadlines consistently.",
                        category: "Soft Skills",
                        demandLevel: "Medium",
                        priority: "High"
                    },
                    {
                        name: "Basic Financial Literacy",
                        description: "Budgeting, saving, and understanding personal finance.",
                        category: "Life Skills",
                        demandLevel: "Medium",
                        priority: "High"
                    }
                ];
            }
            
            return skills;
        }

        function generateSummary(apsScore, average, distinctions) {
            let performanceLevel, universityProspects, recommendation;
            
            if (apsScore >= 35) {
                performanceLevel = "Outstanding";
                universityProspects = "Excellent - Access to highly competitive programs";
                recommendation = "Apply to research universities and consider honors programs";
            } else if (apsScore >= 28) {
                performanceLevel = "Excellent";
                universityProspects = "Very Good - Most degree programs accessible";
                recommendation = "Apply to comprehensive universities with your preferred programs";
            } else if (apsScore >= 24) {
                performanceLevel = "Good";
                universityProspects = "Good - Diploma and certificate programs recommended";
                recommendation = "Consider universities of technology and career-focused programs";
            } else if (apsScore >= 20) {
                performanceLevel = "Satisfactory";
                universityProspects = "Fair - Focus on skills development and vocational training";
                recommendation = "Explore TVET colleges and skills development programs";
            } else {
                performanceLevel = "Needs Improvement";
                universityProspects = "Limited - Academic improvement recommended";
                recommendation = "Focus on improving key subjects and consider rewrite options";
            }
            
            return {
                performanceLevel: performanceLevel,
                universityProspects: universityProspects,
                recommendation: recommendation,
                distinctionCount: distinctions
            };
        }

        function displayGrade11_12Results(data) {
            // Update APS score
            document.getElementById('apsValue').textContent = data.apsScore;
            document.getElementById('apsDescription').textContent = getAPSDescription(data.apsScore);
            
            // Update overall average
            document.getElementById('overallAverage').textContent = `${data.overallAverage}%`;
            
            // Update subjects count
            document.getElementById('subjectsCount').textContent = data.subjects.length;
            
            // Update distinction count
            const distinctionCount = data.subjects.filter(s => s.mark >= 80).length;
            document.getElementById('distinctionCount').textContent = distinctionCount;
            
            // Update performance level
            const performanceLevel = document.getElementById('performanceLevel');
            performanceLevel.textContent = data.summary.performanceLevel;
            performanceLevel.className = `performance-tag ${data.summary.performanceLevel.toLowerCase().replace(' ', '-')}`;
            
            // Display APS breakdown
            displayAPSBreakdown(data.apsBreakdown);
            
            // Display course recommendations
            displayCourseRecommendations(data.courses);
            
            // Display market insights
            displayMarketInsights(data.marketInsights);
            
            // Display skill recommendations
            displaySkillRecommendations(data.skills);
            
            // Display university prospects
            displayUniversityProspects(data.summary);
        }

        function displayAPSBreakdown(breakdown) {
            const breakdownElement = document.getElementById('apsBreakdown');
            let html = '';
            
            breakdown.breakdown.forEach(item => {
                html += `
                    <div class="breakdown-item">
                        <div class="breakdown-subject">${item.subject}</div>
                        <div class="breakdown-mark">${item.mark}%</div>
                        <div class="breakdown-level level-${item.level.toLowerCase().replace(' ', '-')}">${item.level}</div>
                        <div class="breakdown-points">${item.points} pts</div>
                    </div>
                `;
            });
            
            html += `
                <div class="breakdown-total">
                    <div class="total-label">Total APS Score</div>
                    <div class="total-points">${breakdown.totalPoints}</div>
                </div>
            `;
            
            breakdownElement.innerHTML = html;
        }

        function displayCourseRecommendations(courses) {
            const courseList = document.getElementById('courseList');
            let html = '';
            
            courses.forEach(course => {
                const categoryClass = course.category.toLowerCase().replace(/ /g, '-');
                const demandClass = `demand-${course.marketDemand}`;
                
                html += `
                    <div class="course-card ${categoryClass}">
                        <div class="course-header">
                            <h4>${course.name}</h4>
                            <div>
                                <span class="course-category">${course.category}</span>
                                <span class="market-demand-indicator ${demandClass}">${course.marketDemand.toUpperCase()} DEMAND</span>
                            </div>
                        </div>
                        <p class="course-description">${course.description}</p>
                        
                        ${course.matchScore ? `
                        <div class="recommendation-score">
                            <span>Personal Match:</span>
                            <div class="score-bar">
                                <div class="score-fill" style="width: ${course.matchScore}%"></div>
                            </div>
                            <span>${course.matchScore}%</span>
                        </div>
                        ` : ''}
                        
                        <div class="course-details">
                            <div class="detail-section">
                                <label> Institutions</label>
                                <div class="institutions">${course.institutions.join(', ')}</div>
                            </div>
                            <div class="detail-section">
                                <label> Requirements</label>
                                <p>${course.requirements}</p>
                            </div>
                            <div class="detail-row">
                                <div class="detail-item">
                                    <label> Prospects</label>
                                    <span>${course.jobProspects}</span>
                                </div>
                                <div class="detail-item">
                                    <label> Duration</label>
                                    <span>${course.duration}</span>
                                </div>
                                <div class="detail-item">
                                    <label> Salary</label>
                                    <span>${course.salaryRange}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            courseList.innerHTML = html;
        }

        function displayMarketInsights(insights) {
            const insightsContainer = document.getElementById('marketInsights');
            let html = '';
            
            if (insights && insights.length > 0) {
                insights.forEach(insight => {
                    const demandClass = `demand-${insight.demand}`;
                    
                    html += `
                        <div class="insight-card">
                            <div class="insight-header">
                                <i class="fas fa-chart-line insight-icon"></i>
                                <h4>${insight.category} Market Outlook</h4>
                            </div>
                            <div class="factor-item">
                                <span>Market Demand:</span>
                                <span class="factor-value ${demandClass}">${insight.demand.toUpperCase()}</span>
                            </div>
                            <div class="factor-item">
                                <span>Growth Rate:</span>
                                <span class="factor-value">${insight.growth}</span>
                            </div>
                            <div class="factor-item">
                                <span>Average Salary:</span>
                                <span class="factor-value">${insight.salary}</span>
                            </div>
                            <div class="factor-item">
                                <span>Career Outlook:</span>
                                <span class="factor-value">${insight.outlook}</span>
                            </div>
                        </div>
                    `;
                });
            } else {
                html = `
                    <div class="insight-card">
                        <p>Select interests to view market insights for your preferred career fields.</p>
                    </div>
                `;
            }
            
            insightsContainer.innerHTML = html;
        }

        function displaySkillRecommendations(skills) {
            const skillList = document.getElementById('skillList');
            let html = '';
            
            skills.forEach(skill => {
                html += `
                    <div class="skill-card ${skill.demandLevel.toLowerCase()}">
                        <div class="skill-header">
                            <h4>${skill.name}</h4>
                            <span class="skill-demand ${skill.demandLevel.toLowerCase()}">${skill.demandLevel} Demand</span>
                        </div>
                        <p class="skill-description">${skill.description}</p>
                        <div class="skill-meta">
                            <span class="skill-category">${skill.category}</span>
                            <span class="skill-priority">${skill.priority}</span>
                        </div>
                    </div>
                `;
            });
            
            skillList.innerHTML = html;
        }

        function displayUniversityProspects(summary) {
            const universityInfo = document.getElementById('universityInfo');
            const prospectClass = summary.universityProspects.toLowerCase().includes('excellent') ? 'excellent' : 
                                summary.universityProspects.toLowerCase().includes('good') ? 'good' : 'fair';
            
            universityInfo.innerHTML = `
                <div class="prospect-card ${prospectClass}">
                    <div class="prospect-header">
                        <i class="fas fa-graduation-cap"></i>
                        <h4>Admission Prospects</h4>
                    </div>
                    <p class="prospect-message">${summary.universityProspects}</p>
                    <div class="prospect-details">
                        <div class="prospect-item">
                            <label>Overall Performance</label>
                            <span>${summary.performanceLevel}</span>
                        </div>
                        <div class="prospect-item">
                            <label>Recommendation</label>
                            <span>${summary.recommendation}</span>
                        </div>
                    </div>
                </div>
            `;
        }

        function updateStepIndicator(step) {
            const steps = document.querySelectorAll('.step-indicator .step');
            steps.forEach((s, index) => {
                if (index + 1 <= step) {
                    s.classList.add('active');
                } else {
                    s.classList.remove('active');
                }
            });

            const stepContents = document.querySelectorAll('.step-content');
            stepContents.forEach((content, index) => {
                if (index + 1 === step) {
                    content.classList.add('active');
                } else {
                    content.classList.remove('active');
                }
            });
        }

        function getLevel(mark) {
            if (mark >= 80) return 'Distinction';
            if (mark >= 70) return 'Merit';
            if (mark >= 60) return 'Achieved';
            if (mark >= 50) return 'Satisfactory';
            if (mark >= 40) return 'Elementary';
            return 'Not Achieved';
        }

        function getAPSDescription(apsScore) {
            if (apsScore >= 35) return 'Excellent university prospects - Highly competitive programs available';
            if (apsScore >= 28) return 'Very good prospects - Most university programs accessible';
            if (apsScore >= 24) return 'Good prospects - Diploma and degree options available';
            if (apsScore >= 20) return 'Fair prospects - Consider technical and vocational paths';
            return 'Focus on skills development and academic improvement';
        }

        function resetForm() {
            // Reset to step 1
            updateStepIndicator(1);
            
            // Clear all data
            uploadedFile = null;
            manualSubjects = [];
            selectedInterests = [];
            
            // Reset file upload
            resetFileUpload();
            
            // Clear manual subjects
            document.getElementById('subjectsList').innerHTML = '';
            
            // Reset interest selection
            document.querySelectorAll('.interest-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // Hide results
            document.getElementById('resultsContainer').style.display = 'none';
            document.getElementById('loadingResults').style.display = 'none';
            
            // Disable calculate button
            document.getElementById('calculateBtn').disabled = true;
            document.getElementById('analyzeInterestsBtn').disabled = true;
        }

        // Make removeManualSubject available globally
        window.removeManualSubject = removeManualSubject;
    </script>
</body>
</html>